'use client';

import { useEffect, useState } from 'react';
import Link from 'next/link';
import Image from 'next/image';
import { Game } from '@/types';

// Duel Originals SVG Logo Component
function DuelOriginalsLogo() {
  return (
    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 254 86" className="aspect-[19/4] mb-16 w-[350px]">
      <g fill="#fff" filter="url(#duel-originals_svg__a)">
        <path d="M49.83 43.617c.06 5.304-2.67 8.957-6.765 11.844-3.145 2.18-6.706 3.477-10.385 4.42-1.068.294-2.018 0-2.967-.413-1.01-.53-1.069-1.59-1.128-2.475-.83-8.603-1.602-17.147-2.374-25.75 0-.413-.118-.825-.178-1.238-.178-1.532.356-2.71 1.662-3.535 1.305-.825 2.492-.472 3.68.353.296.177.652.354 1.008.354 4.807.353 8.902 2.357 12.64 5.185 2.315 1.709 3.442 4.243 4.095 6.895.356 1.414.475 2.887.772 4.36zM33.451 54.872c1.306-.118 2.611-.118 3.62-.943 1.84-1.532 3.798-2.887 5.52-4.596 2.907-2.887 3.085-6.835.712-10.135-1.306-1.886-3.205-3.123-5.223-4.066-1.068-.53-2.136-.884-3.323-1.356-.95 7.13-1.484 14.084-1.306 21.155zM72.025 53.517c.831 1.885 2.611 2.474 4.273 1.355.772-.53 1.424-1.179 2.136-1.827.475-.471.95-.943 1.484-1.355.415-.295.95-.59 1.484-.707 1.483-.354 2.67.589 2.61 2.062-.118 2.063-.949 3.771-2.848 4.714-.712.354-1.483.59-2.255.766-1.483.236-2.967.354-4.45.472-1.365.117-2.493-.295-3.561-1.179-4.095-3.359-5.757-10.666-1.9-15.203 1.128-1.355 2.671-2.416 4.274-3.3 3.085-1.709 8.664.53 8.308 5.598 0 .766-.475 1.591-.95 2.24-1.84 2.415-4.45 4.006-7.002 5.538-.475.295-1.01.53-1.484.825zm-.95-4.715c2.79.943 6.173-1.532 5.995-4.301 0-.236-.06-.472-.12-.707-.177-.413-.474-.59-.89-.295-1.958 1.414-3.62 3.182-4.984 5.244zM155.954 45.915c.831-.059 1.424-.118 2.077-.177 1.662-.059 3.383-.176 5.044-.235 2.256-.06 3.383.884 3.383 3.064-.059 5.185-2.848 8.485-8.071 8.662-2.789.059-4.569-1.65-5.816-3.948-1.78-3.24-1.186-6.54 0-9.782.416-1.237 1.128-2.357 1.84-3.476 1.246-1.945 3.323-2.593 5.401-3.182.949-.236 1.78.059 2.136.942.415.884.653 1.886.831 2.888.118.648-.416 1.12-1.009 1.355-1.424.53-2.789 1.002-4.214 1.473-1.068.354-1.127 1.355-1.543 2.416zm4.866 3.241c-1.543.472-3.145.884-4.688 1.414-.119 0-.237.413-.237.649.118.942 1.187 1.767 2.255 1.767 1.424 0 2.611-.707 3.561-1.59.356-.354.415-1.12.415-1.71 0-.176-.712-.294-1.246-.53zM107.589 41.638c.084-4.512 1.518-9.024 4.556-12.768 1.856-2.304 4.134-2.976 6.918-2.88 5.569.288 7.931 4.416 9.535 9.504 1.35 4.127.928 8.063-1.097 11.807-2.11 3.84-4.894 6.816-8.86 8.064-3.712 1.152-6.665-.192-8.606-3.84-1.518-2.88-2.446-6.048-2.446-9.887m15.609 1.056c0-2.88-1.013-5.28-2.447-7.392-.675-.96-1.603-1.632-2.7-1.056-1.519.768-2.784 2.112-2.784 4.128 0 2.111.337 4.32.928 6.24.675 2.207 2.446 3.36 3.881 3.071 1.603-.288 2.7-1.824 3.037-4.32v-.768zM90.6 54.283c1.128-.236 2.315-.53 3.442-.766a55 55 0 0 1 3.323-.649q1.78-.264 3.205.884c1.187.943 1.187 2.416-.059 3.182-.89.53-2.018.943-3.086 1.002-2.908.177-5.757.236-8.605.707-.712.118-1.603-.236-2.255-.59-.356-.176-.534-.942-.534-1.472 0-2.063.296-4.184.237-6.246-.119-4.066.178-8.073.771-12.08.238-1.71 1.247-2.77 2.73-2.77 1.187 0 1.959.59 2.433 1.65.713 1.532.772 3.182.653 4.832-.119 2.416-.712 4.714-1.424 6.953-.475 1.71-.772 3.477-1.128 5.245.119 0 .178.118.297.177zM219.571 34.837c1.84.059 3.858.943 5.401 2.651.415.472.652 1.238.771 1.945.119.648-.178 1.237-.89 1.532s-1.365.295-1.958-.236c-.475-.412-.95-.942-1.484-1.355a11 11 0 0 0-1.958-1.237c-.653-.354-1.247 0-1.721.412-.475.471-.297 1.002 0 1.532.474 1.002 1.246 1.71 2.314 2.063 1.246.471 2.493.884 3.679 1.355 1.603.707 2.73 1.944 3.502 3.477.415.883.475 1.767.237 2.71-.771 2.888-2.789 4.655-5.756 4.95-1.247.118-2.552 0-3.798-.177-1.365-.236-2.374-1.12-3.027-2.416s-.297-2.828.831-3.771c.593-.53 1.246-.471 2.136.118 1.128.707 2.255 1.414 3.383 2.062.297.177.831.236 1.068.06.534-.295 1.068-.767 1.306-1.297.059-.236-.594-.884-1.068-1.12a30 30 0 0 0-3.146-1.414c-2.552-1.002-4.332-2.71-5.163-5.303-1.187-3.595 1.187-6.718 5.46-6.66zM57.308 44.383c-.356 1.768-.653 3.536-1.009 5.244-.297 1.415-.415 2.77-.06 4.184.12.59.416.766.95.648.95-.117 1.602-.707 2.077-1.473.95-1.65 1.365-3.417 1.543-5.303.119-1.355.238-2.71.475-4.007.119-.884.593-1.532 1.484-1.945 1.127-.53 2.373-.176 2.73 1.002.296.884.415 1.945.296 2.888-.297 3.24-1.483 6.187-3.204 8.956-.772 1.297-1.9 2.298-3.146 3.123-1.78 1.179-3.442.472-4.985-.471-1.365-.825-2.255-2.004-2.67-3.594-.95-3.36-.831-6.718.178-10.018.356-1.06 1.127-2.062 1.84-3.005.474-.59 1.246-.884 2.017-.59.772.295 1.069.943 1.128 1.71.119.883.119 1.767.178 2.592h.178zM179.217 47.506c.297 1.709.594 3.359.772 5.068.059.589.118 1.237 0 1.826-.178 1.06-1.009 1.71-2.137 1.65-1.127 0-1.721-.648-1.839-1.827l-1.069-13.612c0-.412 0-.883.119-1.237.237-.648 1.009-.943 1.543-.59.89.59 1.721 1.238 2.374 2.181 1.365 2.121 2.908 4.125 3.679 6.6h.178c0-.825-.059-1.591-.178-2.357-.178-2.063 0-4.066.653-6.01 0-.119 0-.236.059-.295.297-.884 1.009-1.415 1.662-1.415s1.305.648 1.424 1.532c.238 1.827.475 3.654.475 5.54 0 2.239-.356 4.419-.534 6.658 0 .53-.178 1.06-.356 1.532-.534 1.238-1.662 1.591-2.73.766-.712-.53-1.365-1.12-1.84-1.826-.712-1.061-1.305-2.24-1.899-3.36-.118-.235-.237-.53-.356-.765h-.059zM205.803 42.085c-.059 1.532-.237 3.064-.237 4.596 0 .707.119 1.414.297 2.121.118.53.534.648 1.009.354.652-.413 1.305-.943 1.958-1.414.534-.413 1.009-.884 1.543-1.238.949-.59 1.84-.471 2.552.236.712.648 1.009 1.768.534 2.593-.534 1.001-1.187 1.944-2.255 2.533a255 255 0 0 1-5.579 2.947c-.89.471-1.839.353-2.729.059-.416-.118-.772-.649-.95-1.061-.178-.53-.178-1.12-.237-1.709l-.534-9.192c-.178-2.652-.357-5.304-.475-7.897-.06-1.06.237-1.885 1.365-2.298 1.424-.589 2.67-.177 3.086 1.356.296 1.001.415 2.003.474 3.064.06 1.65 0 3.359 0 5.009h.06zM195.596 44.56c-.237-1.415-.653-2.652-1.365-3.713-.296-.471-.652-.648-1.127 0-.653.884-2.018 1.002-2.908.413-.89-.59-1.068-1.65-.534-2.711 1.068-2.004 3.442-2.416 5.341-1.06 2.908 2.062 3.56 5.008 3.442 8.19-.06 2.063.415 3.83 1.721 5.421.356.472.712.943 1.009 1.474.356.648.474 1.355-.06 2.003-.534.59-1.483.943-2.255.707-1.068-.353-1.899-.943-2.492-1.886-.178-.353-.416-.648-.653-1.06-.475.353-.95.648-1.424.943-.475.294-.891.53-1.365.825-2.315 1.414-5.223-1.12-4.807-3.36.356-1.826.712-3.653 1.958-5.126 1.424-1.709 3.027-2.062 5.104-1.12.118 0 .178.06.415.177zm-4.807 5.539c0 1.532.297 1.708 1.484 1.296 1.484-.53 2.136-1.827 2.492-3.182.119-.354-.356-1.06-.771-1.355-.237-.177-.89-.177-1.187 0-1.306.766-1.958 1.944-2.018 3.24M136.252 39.08c.771-.354 1.602-.766 2.433-1.12a3.5 3.5 0 0 1 2.67 0c.416.177.891.295 1.365.471 1.069.354 1.484.943 1.306 2.063-.297 1.591-1.068 2.887-2.493 3.712-1.068.648-1.602.53-2.433-.412a2.6 2.6 0 0 0-.296-.472c-1.247 1.591-2.73 2.829-2.849 4.891-.119 1.827-.297 3.654-.415 5.48 0 .708-.238 1.238-1.009 1.415-.653.176-1.602-.236-1.84-.825-.237-.59-.475-1.238-.534-1.886-.297-3.477-.653-6.894-.831-10.371-.059-1.296.119-2.652.356-3.89.297-1.354 2.315-1.767 3.383-.765.475.471.831 1.12 1.187 1.709M147.171 57.052c-1.78-.118-3.026-1.12-2.967-2.71.119-3.242.297-6.542.593-9.782.119-1.592 1.009-3.006 1.959-4.302.415-.59.949-1.179 1.839-.943.891.236 1.306.943 1.365 1.768 0 .294.06.648 0 .943-.712 3.417-.118 6.835 0 10.312 0 .412.238.825.416 1.178.534 1.238.237 2.24-1.009 2.829-.712.353-1.484.471-2.255.707zM173.639 52.22c.059 1.768-1.721 3.359-3.501 3.123-.95-.118-1.425-.766-1.543-1.59a46 46 0 0 1-.356-4.008V43.5c0-.943-.238-1.886-.297-2.829-.06-1.001.296-1.532 1.068-1.708.831-.177 1.543.176 1.899 1.001 1.424 3.182 2.196 6.541 2.433 10.077 0 .766.178 1.473.238 2.18zM151.919 36.192c0 1.355-1.247 2.416-2.849 2.416-1.187 0-2.018-.825-1.958-1.944 0-1.415 1.483-2.77 2.908-2.77 1.068 0 1.958 1.06 1.958 2.298zM171.384 36.074c0 1.002-.712 1.827-1.603 1.886-1.068 0-1.899-.825-1.958-1.886 0-1.237.593-2.062 1.484-2.062 1.008 0 2.017 1.06 2.017 2.121z"></path>
      </g>
      <defs>
        <filter id="duel-originals_svg__a" width="252.803" height="85.219" x=".4" y=".381" colorInterpolationFilters="sRGB" filterUnits="userSpaceOnUse">
          <feFlood floodOpacity="0" result="BackgroundImageFix"></feFlood>
          <feColorMatrix in="SourceAlpha" result="hardAlpha" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"></feColorMatrix>
          <feOffset></feOffset>
          <feGaussianBlur stdDeviation="12.8"></feGaussianBlur>
          <feComposite in2="hardAlpha" operator="out"></feComposite>
          <feColorMatrix values="0 0 0 0 0.13092 0 0 0 0 0.149191 0 0 0 0 0.350173 0 0 0 1 0"></feColorMatrix>
          <feBlend in2="BackgroundImageFix" result="effect1_dropShadow_107_4676"></feBlend>
          <feBlend in="SourceGraphic" in2="effect1_dropShadow_107_4676" result="shape"></feBlend>
        </filter>
      </defs>
    </svg>
  );
}

// Game Card Component for Hero Section
function HeroGameCard({ game }: { game: Game }) {
  return (
    <Link href={`/${game.slug}`}>
      <div
        className="group relative aspect-[3/4] w-[100px] overflow-hidden rounded-12 bg-cover bg-center transition-all duration-200 hover:brightness-[1.15] md:h-[222px] md:w-[166px]"
        data-testid="game-card-container"
      >
        <Image
          src={game.image}
          alt={game.name}
          fill
          className="absolute inset-0 z-10 object-fill transition-transform duration-300 group-hover:scale-105"
        />
        <div className="absolute inset-x-0 bottom-4 z-30 sm:bottom-8 md:bottom-16">
          <h3 className="text-center text-h-sm !leading-none md:text-h-md lg:text-h-lg">
            {game.name}
          </h3>
          <h4 className="text-center text-b-xs font-semibold text-light-000/30 md:text-b-sm">
            Duel Originals
          </h4>
        </div>
        <div className="absolute left-[6px] top-[6px] z-30 flex gap-2 rounded-6 bg-[rgba(12,16,43,0.60)] px-[6px] py-2 text-[11px] font-semibold text-green-600 md:px-8 md:py-4 md:text-[13px]">
          {game.rtp}% RTP
        </div>
      </div>
    </Link>
  );
}

export function Hero() {
  const [games, setGames] = useState<Game[]>([]);

  useEffect(() => {
    fetch('/api/games?category=originals')
      .then((res) => res.json())
      .then((data) => setGames(data.slice(0, 6))); // Only show first 6 games
  }, []);

  return (
    <div className="relative z-[11]">
      <div className="relative z-10 flex w-full flex-col items-center transition-all duration-700 aspect-[16/10.5] pb-[10%]">
        {/* Background Image Container */}
        <div className="absolute inset-0 transition-opacity duration-200 opacity-100">
          <div className="pointer-events-none absolute left-0 right-0 z-[2] w-full overflow-hidden bg-top bg-no-repeat transition-all duration-700 top-0 aspect-[16/9]">
            <div
              className="absolute inset-0 z-[5] origin-top bg-cover bg-top bg-no-repeat transition-all duration-100 ease-linear"
              style={{ backgroundImage: 'url("/images/header-lg.webp")' }}
            />
          </div>
        </div>

        {/* Hero Text Content */}
        <div className="z-20 px-8 transition-all duration-700 mt-[10%] max-w-[450px]">
          <div className="flex flex-col gap-8 text-center drop-shadow-[0_0_10px_rgba(0,0,0,1)] will-change-transform">
            <h1 className="text-balance text-light-000 transition-all duration-300 text-h-xxl">
              The First Casino That Gives a Fuck.
            </h1>
            <p className="text-balance text-b-lg text-dark-100 md:text-h-md">
              Just the purest form of gambling â€” The way it should be.
            </p>
          </div>
        </div>

        {/* Duel Originals Section */}
        <div className="flex w-full flex-col gap-64 lg:gap-128 mt-[20%]">
          <div className="z-30 w-full transition-all duration-700">
            <div className="flex flex-col items-center">
              <DuelOriginalsLogo />
              <div className="z-0 flex max-w-[1024px] flex-wrap items-center justify-center gap-8 overflow-hidden px-8 sm:px-16 md:gap-16 md:px-32">
                {games.map((game) => (
                  <HeroGameCard key={game.id} game={game} />
                ))}
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  );
}
